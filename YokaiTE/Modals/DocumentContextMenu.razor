@if (Visible)
{
    <div @oncontextmenu:preventDefault="true"
         @oncontextmenu="OnBackdropClick"
         class="modal-back" @onclick="OnBackdropClick">
        <div class="context-menu-modal" style="top:@TopPx; left:@LeftPx;" @onclick:stopPropagation>
            @if (IsFavorite)
            {
                <button class="context-btn rename" @onclick="Favorite">
                    <img src="svg/favoriteOutlined.svg" width="16" height="16" alt="Favoritar" />
                    <span>
                        Desfavoritar
                    </span>
                </button>
            }
            else
            {
                <button class="context-btn rename" @onclick="Favorite">
                    <img src="svg/favoriteFilled.svg" width="16" height="16" alt="Favoritar" />
                    <span>
                        Favoritar
                    </span>
                </button>
            }
            <button class="context-btn rename" @onclick="Rename">
                <img src="svg/pencil.svg" width="16" height="16" alt="Renomear"/>
                <span>
                    Renomear
                </span>
            </button>
            <button class="context-btn delete" @onclick="Delete">
                <img src="svg/trash.svg" width="16" height="16" alt="Renomear"/>
                <span>
                    Excluir
                </span>
            </button>
            @* TODO change icon *@
            <button class="context-btn delete" @onclick="Export">
                <img src="svg/download.svg" width="16" height="16" alt="Download"/>
                <span>
                    Download
                </span>
            </button>
        </div>
    </div>
}

@code {
    [Parameter] public bool Visible { get; set; }
    [Parameter] public EventCallback<bool> VisibleChanged { get; set; }
    [Parameter] public EventCallback OnRename { get; set; }
    [Parameter] public EventCallback OnSetFavorite { get; set; }
    [Parameter] public EventCallback OnDelete { get; set; }
    [Parameter] public EventCallback OnExport { get; set; }
    [Parameter] public int Top { get; set; }
    [Parameter] public int Left { get; set; }
    [Parameter] public bool IsFavorite { get; set; } = false;

    private string TopPx => $"{Top}px";
    private string LeftPx => $"{Left}px";

    private async Task OnBackdropClick()
    {
        await VisibleChanged.InvokeAsync(false);
    }

    private async Task Rename()
    {
        await OnRename.InvokeAsync();
        await VisibleChanged.InvokeAsync(false);
    }

    private async Task Favorite()
    {
        await OnSetFavorite.InvokeAsync();
        await VisibleChanged.InvokeAsync(false);
    }

    private async Task Delete()
    {
        await OnDelete.InvokeAsync();
        await VisibleChanged.InvokeAsync(false);
    }

    private async Task Export()
    {
        await OnExport.InvokeAsync();
        await VisibleChanged.InvokeAsync(false);
    }

}